import { Component, OnInit } from '@angular/core';
import { FormControl, FormsModule, ReactiveFormsModule } from '@angular/forms';
import { MatAutocompleteModule } from '@angular/material/autocomplete';
import { MatInputModule } from '@angular/material/input';
import { MatFormFieldModule } from '@angular/material/form-field';
import { MatButtonModule } from '@angular/material/button';
import { MatCardModule } from '@angular/material/card';
import { Router } from '@angular/router';
import { map, Observable, startWith } from 'rxjs';
import { AsyncPipe } from '@angular/common';
import { StockService } from '../../services/stock.service';

@Component({
  standalone: true,
  selector: 'app-home',
  imports: [
    FormsModule,
    MatAutocompleteModule,
    MatInputModule,
    MatFormFieldModule,
    MatButtonModule,
    MatCardModule,
    ReactiveFormsModule,
    AsyncPipe
  ],
  templateUrl: './home.component.html',
  styleUrl: './home.component.scss'
})
export class HomeComponent implements OnInit {
  selectedStock: string = '';
  stocks: any[] = ['AA - Alcoa Corp', 'AAL - American Airlines Group Inc', 'AAPL - Apple Inc.', 'ABBV - AbbVie Inc.', 'ABNB - Airbnb, Inc.', 'ACHR - Archer Aviation Inc', 'ACN - Accenture plc', 'ADBE - Adobe Inc.', 'ADI - Analog Devices, Inc.', 'ADM - Archer-Daniels-Midland Company', 'ADP - Automatic Data Processing, Inc.', 'ADSK - Autodesk, Inc.', 'AEE - Ameren Corporation', 'AEP - American Electric Power Company', 'AES - The AES Corporation', 'AFL - AFLAC Incorporated', 'AIG - American International Group, I', 'AKAM - Akamai Technologies, Inc.', 'ALB - Albemarle Corporation', 'ALGN - Align Technology, Inc.', 'ALLE - Allegion plc', 'AMAT - Applied Materials, Inc.', 'AMC - AMC Entertainment Holdings Inc', 'AMCR - Amcor plc', 'AMD - Advanced Micro Devices, Inc.', 'AME - AMETEK, Inc.', 'AMGN - Amgen Inc.', 'AMP - Ameriprise Financial, Inc.', 'AMT - American Tower Corporation', 'AMTM - Amentum Holdings, Inc.', 'AMZN - Amazon.com, Inc.', 'ANET - Arista Networks, Inc.', 'ANSS - ANSYS, Inc.', 'AON - Aon plc', 'AOS - A.O. Smith Corporation', 'APA - APA Corporation', 'APD - Air Products and Chemicals, Inc', 'APH - Amphenol Corporation', 'APTV - Aptiv PLC', 'ASTS - AST SpaceMobile Inc', 'ATO - Atmos Energy Corporation', 'AVB - AvalonBay Communities, Inc.', 'AVGO - Broadcom Inc.', 'AVY - Avery Dennison Corporation', 'AWK - American Water Works Company, I', 'AXON - Axon Enterprise, Inc.', 'AXP - American Express Company', 'AZO - AutoZone, Inc.', 'BA - Boeing Company ', 'BABA - Alibaba Group Holding Ltd', 'BAC - Bank of America Corporation', 'BALL - Ball Corporation', 'BAX - Baxter International Inc.', 'BBY - BlackBerry Ltd', 'BDX - Becton, Dickinson and Company', 'BEN - Franklin Resources, Inc.', 'BG - Bunge Limited', 'BIIB - Biogen Inc.', 'BK - The Bank of New York Mellon Cor', 'BKNG - Booking Holdings Inc. Common St', 'BKR - Baker Hughes Company', 'BLDR - Builders FirstSource, Inc.', 'BLK - BlackRock, Inc.', 'BMY - Bristol-Myers Squibb Company', 'BR - Broadridge Financial Solutions,', 'BSX - Boston Scientific Corporation', 'BX - Blackstone Inc.', 'BXP - BXP, Inc.', 'CAG - ConAgra Brands, Inc.', 'CAH - Cardinal Health, Inc.', 'CARR - Carrier Global Corporation', 'CB - Chubb Limited', 'CBOE - Cboe Global Markets, Inc.', 'CBRE - CBRE Group Inc', 'CC - Chemours Co', 'CCI - Crown Castle Inc.', 'CCL - Carnival Corporation', 'CDNS - Cadence Design Systems, Inc.', 'CDW - CDW Corporation', 'CE - Celanese Corporation', 'CEG - Constellation Energy Corporatio', 'CF - CF Industries Holdings, Inc.', 'CFG - Citizens Financial Group, Inc.', 'CHD - Church & Dwight Company, Inc.', 'CHRW - C.H. Robinson Worldwide, Inc.', 'CHTR - Charter Communications, Inc.', 'CI - The Cigna Group', 'CL - Colgate-Palmolive Company', 'CLOV - Clover Health Investments Corp', 'CLX - Clorox Company ', 'CMCSA - Comcast Corporation', 'CME - CME Group Inc.', 'CMG - Chipotle Mexican Grill, Inc.', 'CMI - Cummins Inc.', 'CMS - CMS Energy Corporation', 'CNC - Centene Corporation', 'CNP - CenterPoint Energy, Inc', 'COF - Capital One Financial Corporati', 'COO - The Cooper Companies, Inc.', 'COP - ConocoPhillips', 'COR - Cencora, Inc.', 'COST - Costco Wholesale Corporation', "CPB - The Campbell's Company", 'CPRT - Copart, Inc.', 'CPT - Camden Property Trust', 'CRL - Charles River Laboratories Inte', 'CRM - Salesforce, Inc.', 'CRWD - CrowdStrike Holdings, Inc.', 'CSCO - Cisco Systems, Inc.', 'CSGP - CoStar Group, Inc.', 'CSX - CSX Corporation', 'CTAS - Cintas Corporation', 'CTRA - Coterra Energy Inc.', 'CTSH - Cognizant Technology Solutions ', 'CTVA - Corteva, Inc.', 'CVS - CVS Health Corporation', 'CVX - Chevron Corporation', 'CZR - Caesars Entertainment, Inc.', 'DAL - Delta Air Lines, Inc.', 'DE - Deere & Company', 'DECK - Deckers Outdoor Corporation', 'DELL - Dell Technologies Inc.', 'DFS - Discover Financial Services', 'DG - Dollar General Corp', 'DGX - Quest Diagnostics Incorporated', 'DHI - D.R. Horton, Inc.', 'DHR - Danaher Corporation', 'DIS - Walt Disney Company', 'DJT - Trump Media & Technology Group Corp', 'DLR - Digital Realty Trust, Inc.', 'DLTR - Dollar Tree, Inc.', 'DM - Desktop Metal Inc', 'DOC - Healthpeak Properties, Inc.', 'DOCU - DocuSign Inc.', 'DOV - Dover Corporation', 'DOW - Dow Inc.', "DPZ - Domino's Pizza Inc", 'DRI - Darden Restaurants, Inc.', 'DTE - DTE Energy Company', 'DUK - Duke Energy Corporation', 'DVA - DaVita Inc.', 'DVN - Devon Energy Corporation', 'DXCM - DexCom, Inc.', 'EA - Electronic Arts Inc.', 'EBAY - eBay Inc.', 'ECL - Ecolab Inc.', 'ED - Consolidated Edison, Inc.', 'EFX - Equifax, Inc.', 'EG - Everest Group, Ltd.', 'EIX - Edison International', 'EL - Estee Lauder Companies, Inc.', 'ELV - Elevance Health, Inc.', 'EMN - Eastman Chemical Company', 'EMR - Emerson Electric Company', 'ENPH - Enphase Energy, Inc.', 'EOG - EOG Resources, Inc.', 'EPAM - EPAM Systems, Inc.', 'EQIX - Equinix, Inc.', 'EQR - Equity Residential', 'EQT - EQT Corporation', 'ERIE - Erie Indemnity Company', 'ES - Eversource Energy', 'ESS - Essex Property Trust, Inc.', 'ETN - Eaton Corporation, PLC', 'ETR - Entergy Corporation', 'EU - enCore Energy Corp', 'EVRG - Evergy, Inc.', 'EW - Edwards Lifesciences Corporatio', 'EXC - Exelon Corporation', 'EXPD - Expeditors International of Was', 'EXPE - Expedia Group, Inc.', 'EXR - Extra Space Storage Inc', 'FANG - Diamondback Energy, Inc.', 'FAST - Fastenal Company', 'FCX - Freeport-McMoRan, Inc.', 'FDS - FactSet Research Systems Inc.', 'FDX - FedEx Corporation', 'FE - FirstEnergy Corp.', 'FFIV - F5, Inc.', 'FI - Fiserv, Inc.', 'FICO - Fair Isaac Corporation', 'FIS - Fidelity National Information S', 'FITB - Fifth Third Bancorp', 'FMC - FMC Corporation', 'FOX - Fox Corporation', 'FOXA - Fox Corporation', 'FRT - Federal Realty Investment Trust', 'FSLR - First Solar, Inc.', 'FTNT - Fortinet, Inc.', 'GAP - Gap Inc', 'GD - General Dynamics Corporation', 'GDDY - GoDaddy Inc.', 'GE - GE Aerospace', 'GEHC - GE HealthCare Technologies Inc.', 'GEN - Gen Digital Inc.', 'GEV - GE Vernova Inc.', 'GILD - Gilead Sciences, Inc.', 'GIS - General Mills, Inc.', 'GL - Globe Life Inc.', 'GLD - SPDR Gold Trust', 'GLW - Corning Incorporated', 'GM - General Motors Company', 'GME - GameStop Corp', 'GNRC - Generac Holdlings Inc.', 'GOOG - Alphabet Inc.', 'GOOGL - Alphabet Inc.', 'GPC - Genuine Parts Company', 'GPN - Global Payments Inc.', 'GRMN - Garmin Ltd.', 'GS - Goldman Sachs Group, Inc.', 'GWW - W.W. Grainger, Inc.', 'HAL - Halliburton Company', 'HBAN - Huntington Bancshares Incorpora', 'HCA - HCA Healthcare, Inc.', 'HD - Home Depot, Inc.', 'HES - Hess Corporation', 'HIG - Hartford Financial Services Gro', 'HII - Huntington Ingalls Industries, ', 'HLT - Hilton Worldwide Holdings Inc.', 'HOLX - Hologic, Inc.', 'HON - Honeywell International Inc.', 'HOOD - Robinhood Markets, Inc.', 'HPE - Hewlett Packard Enterprise Comp', 'HPQ - HP Inc.', 'HRL - Hormel Foods Corporation', 'HSIC - Henry Schein, Inc.', 'HST - Host Hotels & Resorts, Inc.', 'HSY - The Hershey Company', 'HUBB - Hubbell Inc', 'HUM - Humana Inc.', 'HWM - Howmet Aerospace Inc.', 'IBM - International Business Machines', 'ICE - Intercontinental Exchange Inc.', 'IEX - IDEX Corporation', 'IFF - International Flavors & Fragran', 'INCY - Incyte Corporation', 'INTC - Intel Corporation', 'INTU - Intuit Inc.', 'INVH - Invitation Homes Inc.', 'IP - International Paper Company', 'IPA - ImmunoPrecise Antibodies', 'IPG - Interpublic Group of Companies,', 'IR - Ingersoll Rand Inc.', 'IRM - Iron Mountain Incorporated', 'ISRG - Intuitive Surgical, Inc.', 'ITW - Illinois Tool Works Inc.', 'IVZ - Invesco Ltd', 'IWM - iShares Russell 2000 ETF', 'JBHT - J.B. Hunt Transport Services, I', 'JBL - Jabil Inc.', 'JCI - Johnson Controls International ', 'JD - JD.Com Inc', 'JKHY - Jack Henry & Associates, Inc.', 'JNJ - Johnson & Johnson', 'JNPR - Juniper Networks, Inc.', 'JPM - JP Morgan Chase & Co.', 'KDP - Keurig Dr Pepper Inc.', 'KEYS - Keysight Technologies Inc.', 'KHC - The Kraft Heinz Company', 'KIM - Kimco Realty Corporation (HC)', 'KKR - KKR & Co. Inc.', 'KLAC - KLA Corporation', 'KMB - Kimberly-Clark Corporation', 'KMI - Kinder Morgan, Inc.', 'KMX - CarMax Inc', 'KO - Coca-Cola Company', 'KR - Kroger Company ', 'KVUE - Kenvue Inc.', 'LDOS - Leidos Holdings, Inc.', 'LEN - Lennar Corporation', 'LH - Labcorp Holdings Inc.', 'LHX - L3Harris Technologies, Inc.', 'LIN - Linde plc', 'LKQ - LKQ Corporation', 'LLY - Eli Lilly and Company', 'LMT - Lockheed Martin Corporation', 'LNT - Alliant Energy Corporation', 'LOGC - ContextLogic Inc', 'LRCX - Lam Research Corporation', 'LULU - lululemon athletica inc.', 'LUNR - Intuitive Machines Inc', 'LVS - Las Vegas Sands Corp.', 'LW - Lamb Weston Holdings, Inc.', 'LYB - LyondellBasell Industries NV', 'LYV - Live Nation Entertainment, Inc.', 'MAA - Mid-America Apartment Communiti', 'MAR - Marriott International', 'MAS - Masco Corporation', "MCD - McDonald's Corporation", 'MCHP - Microchip Technology Incorporat', 'MCK - McKesson Corporation', "MCO - Moody's Corporation", 'MDLZ - Mondelez International, Inc.', 'MDT - Medtronic plc.', 'MET - MetLife, Inc.', 'META - Meta Platforms, Inc.', 'MGM - MGM Resorts International', 'MHK - Mohawk Industries, Inc.', 'MKC - McCormick & Company, Incorporat', 'MKTX - MarketAxess Holdings, Inc.', 'MLM - Martin Marietta Materials, Inc.', 'MMM - 3M Company', 'MNST - Monster Beverage Corporation', 'MO - Altria Group, Inc.', 'MOH - Molina Healthcare Inc', 'MOS - Mosaic Company ', 'MPC - Marathon Petroleum Corporation', 'MPWR - Monolithic Power Systems, Inc.', 'MRK - Merck & Company, Inc.', 'MRNA - Moderna, Inc.', 'MS - Morgan Stanley', 'MSCI - MSCI Inc.', 'MSFT - Microsoft Corporation', 'MSI - Motorola Solutions, Inc.', 'MSTR - MicroStrategy Inc', 'MTB - M&T Bank Corporation', 'MTCH - Match Group, Inc.', 'MTD - Mettler-Toledo International, I', 'MU - Micron Technology, Inc.', 'NCLH - Norwegian Cruise Line Holdings ', 'NDAQ - Nasdaq, Inc.', 'NDSN - Nordson Corporation', 'NEE - NextEra Energy, Inc.', 'NEM - Newmont Corporation', 'NFLX - Netflix, Inc.', 'NIO - Nio Inc', 'NKE - Nike, Inc.', 'NOC - Northrop Grumman Corporation', 'NRG - NRG Energy, Inc.', 'NSC - Norfolk Southern Corporation', 'NTAP - NetApp, Inc.', 'NTRS - Northern Trust Corporation', 'NUE - Nucor Corporation', 'NVDA - NVIDIA Corporation', 'NVR - NVR, Inc.', 'NWS - News Corporation', 'NXPI - NXP Semiconductors N.V.', 'NYT - New York Times Co', 'ODFL - Old Dominion Freight Line, Inc.', 'OKE - ONEOK, Inc.', 'OKLO - Oklo Inc', 'OMC - Omnicom Group Inc.', 'ORCL - Oracle Corporation', "ORLY - O'Reilly Automotive, Inc.", 'OTIS - Otis Worldwide Corporation', 'OXY - Occidental Petroleum Corporatio', 'PANW - Palo Alto Networks, Inc.', 'PARA - Paramount Global', 'PAYC - Paycom Software, Inc.', 'PAYX - Paychex, Inc.', 'PCAR - PACCAR Inc.', 'PCG - Pacific Gas & Electric Co.', 'PEG - Public Service Enterprise Group', 'PEP - Pepsico, Inc.', 'PFE - Pfizer, Inc.', 'PFG - Principal Financial Group Inc', 'PG - Procter & Gamble Company ', 'PGR - Progressive Corporation ', 'PH - Parker-Hannifin Corporation', 'PHM - PulteGroup, Inc.', 'PLD - Prologis, Inc.', 'PLTR - Palantir Technologies Inc.', 'PM - Philip Morris International Inc', 'PNC - PNC Financial Services Group, I', 'PNW - Pinnacle West Capital Corporati', 'PODD - Insulet Corporation', 'POOL - Pool Corporation', 'PPG - PPG Industries, Inc.', 'PR - Permian Resources Corp', 'PRU - Prudential Financial, Inc.', 'PSA - Public Storage', 'PSX - Phillips 66', 'PTC - PTC Inc.', 'PTON - Peloton Interactive Inc', 'PWR - Quanta Services, Inc.', 'PYPL - PayPal Holdings, Inc.', 'QBTS - D-Wave Quantum Inc.', 'QCOM - QUALCOMM Incorporated', 'QQQ - Invesco QQQ ETF', 'QRVO - Qorvo, Inc.', 'RCL - Royal Caribbean Cruises Ltd.', 'RDDT - Reddit Inc.', 'REG - Regency Centers Corporation', 'REGN - Regeneron Pharmaceuticals, Inc.', 'RF - Regions Financial Corporation', 'RGTI - Rigetti Computing Inc', 'RIVN - Rivian Automotive Inc', 'RJF - Raymond James Financial, Inc.', 'RKLB - Rocket Lab USA Inc', 'RL - Ralph Lauren Corporation', 'RMD - ResMed Inc.', 'ROK - Rockwell Automation, Inc.', 'ROL - Rollins, Inc.', 'ROP - Roper Technologies, Inc.', 'ROST - Ross Stores, Inc.', 'RR - Richtech Robotics Inc', 'RTX - RTX Corporation', 'SBAC - SBA Communications Corporation', 'SBUX - Starbucks Corporation', 'SCHW - Charles Schwab Corporation ', 'SHW - Sherwin-Williams Company ', 'SJM - The J.M. Smucker Company', 'SLB - Schlumberger N.V.', 'SMCI - Super Micro Computer, Inc.', 'SMTC - Semtech Corp', 'SNPS - Synopsys, Inc.', 'SOFI - SoFi Technologies Inc', 'SOLV - Solventum Corporation', 'SPG - Simon Property Group, Inc.', 'SPGI - S&P Global Inc.', 'SPY - SPDR S&P 500 ETF Trust', 'SQQQ - ProShares Trust - ProShares UltraPro Short QQQ', 'SRE - DBA Sempra', 'STE - STERIS plc (Ireland)', 'STLD - Steel Dynamics, Inc.', 'STX - Seagate Technology Holdings PLC', 'STZ - Constellation Brands, Inc.', 'SW - Smurfit WestRock plc', 'SWK - Stanley Black & Decker, Inc.', 'SWKS - Skyworks Solutions, Inc.', 'SYF - Synchrony Financial', 'SYK - Stryker Corporation', 'SYY - Sysco Corporation', 'TAP - Molson Coors Beverage Company', 'TDG - Transdigm Group Incorporated', 'TDY - Teledyne Technologies Incorpora', 'TECH - Bio-Techne Corp', 'TEL - TE Connectivity plc', 'TER - Teradyne, Inc.', 'TFC - Truist Financial Corporation', 'TFX - Teleflex Incorporated', 'TGT - Target Corporation', 'TJX - TJX Companies, Inc.', 'TLT - iShares 20+ Year Treasury Bond ETF', 'TMO - Thermo Fisher Scientific Inc', 'TMUS - T-Mobile US, Inc.', 'TPL - Texas Pacific Land Corporation', 'TPR - Tapestry, Inc.', 'TQQQ - ProShares Trust - ProShares UltraPro QQQ', 'TRGP - Targa Resources, Inc.', 'TROW - T. Rowe Price Group, Inc.', 'TRV - The Travelers Companies, Inc.', 'TSCO - Tractor Supply Company', 'TSLA - Tesla, Inc.', 'TSM - Taiwan Semiconductor Mfg. Co. Ltd.', 'TSN - Tyson Foods, Inc.', 'TT - Trane Technologies plc', 'TTD - Trade Desk Inc', 'TTWO - Take-Two Interactive Software, ', 'TWLO - Twilio Inc', 'TXN - Texas Instruments Incorporated', 'TXT - Textron Inc.', 'TYL - Tyler Technologies, Inc.', 'UAL - United Airlines Holdings, Inc.', 'UBER - Uber Technologies, Inc.', 'UHS - Universal Health Services, Inc.', 'ULTA - Ulta Beauty, Inc.', 'UNH - UnitedHealth Group Incorporated', 'UNP - Union Pacific Corporation', 'UPS - United Parcel Service, Inc.', 'URI - United Rentals, Inc.', 'USB - U.S. Bancorp', 'VICI - VICI Properties Inc.', 'VLO - Valero Energy Corporation', 'VOO - Vanguard S&P 500 ETF', 'VRSN - VeriSign, Inc.', 'VRTX - Vertex Pharmaceuticals Incorpor', 'VST - Vistra Corp.', 'VTR - Ventas, Inc.', 'VTRS - Viatris Inc.', 'VZ - Verizon Communications Inc', 'WAB - Westinghouse Air Brake Technolo', 'WAT - Waters Corporation', 'WBA - Walgreens Boots Alliance, Inc.', 'WBD - Warner Bros. Discovery, Inc. - ', 'WDC - Western Digital Corporation', 'WEC - WEC Energy Group, Inc.', "WEN - Wendy's Co", 'WFC - Wells Fargo & Company', 'WH - Wyndham Hotels & Resorts Inc', 'WM - Waste Management, Inc.', 'WMB - Williams Companies, Inc. ', 'WMT - Walmart Inc.', 'WST - West Pharmaceutical Services, I', 'WW - WW International Inc', 'WY - Weyerhaeuser Company', 'WYNN - Wynn Resorts, Limited', 'XEL - Xcel Energy Inc.', 'XOM - Exxon Mobil Corporation', 'XYL - Xylem Inc.', 'YUM - Yum! Brands, Inc.', 'ZBH - Zimmer Biomet Holdings, Inc.', 'ZBRA - Zebra Technologies Corporation', 'ZTS - Zoetis Inc.'];
  stockString = new FormControl('');
  filteredOptions: Observable<string[]> = new Observable();

  constructor(private router: Router, private service: StockService) {}

  ngOnInit() {
    this.filteredOptions = this.stockString.valueChanges.pipe(
      startWith(''),
      map(value => this._filter(value || '')),
    );
  }

  private _filter(value: string): string[] {
    const filterValue = value.toLowerCase();

    return this.stocks.filter(option => option.toLowerCase().includes(filterValue));
  }

  // Filtered stock list based on user input
  filteredStocks(): string[] {
    return this.stocks.filter(stock =>
      stock.toLowerCase().includes(this.selectedStock.toLowerCase())
    );
  }

  // Navigate to analysis page
  getAnalysis(): void {
    if (this.selectedStock) {
      const ticker = this.selectedStock.split(" - ")[0]; // Extracts the part before " - "
      this.router.navigate([ticker]);
    }
  }
}
